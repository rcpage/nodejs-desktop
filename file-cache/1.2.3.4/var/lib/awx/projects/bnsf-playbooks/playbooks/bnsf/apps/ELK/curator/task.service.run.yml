---
    - name: "Find config files: {{ curator.actionDirectory }}"
      find:
        paths: "{{curator.actionDirectory}}"
      register: config_folder

    - debug: var=config_folder

    - set_fact:
        cmd: "{{curator.directory}}/curator --config {{curator.directory}}/{{curator.configFile}} {{curator.actionDirectory}}"
    
    - debug: var=cmd

    - debug: 
        msg: "{{ 'runuser -l ' ~ elk.userName ~ ' -c \"' ~ cmd ~ '/' ~ item.path.split('/').pop() ~ '\"' }}"
      with_items: "{{ config_folder.files }}"

    - name: "Start curator service."
      become: yes      
      shell: "{{ 'runuser -l ' ~ elk.userName ~ ' -c \"' ~ cmd ~ '/' ~ item.path.split('/').pop() ~ '\"' }}"
      with_items: "{{config_folder.files}}"
      register: curator_run

    - debug: var=curator_run
